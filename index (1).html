<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteio Amigo Oculto</title>
<style>
body { font-family: Arial; background:#f3f3f3; margin:0; padding:20px; }
.container{ max-width:500px; margin:auto; background:white; padding:20px; border-radius:10px; }
input, button{ width:100%; padding:10px; margin:5px 0; }
button{ cursor:pointer; background:#28a745; color:white; border:0; border-radius:5px; }
.msg{ padding:10px; margin-top:10px; border-radius:5px; display:none; }
.err{ background:#ffcccc; }
.ok{ background:#ccffcc; }
</style>
</head>
<body>

<div class="container">
<h2>ğŸ Criar Evento</h2>
<input id="eventoNome" placeholder="Nome do evento">
<input id="eventoParticipantes" placeholder="Participantes separados por vÃ­rgula">
<button onclick="criarEvento()">Criar evento</button>

<h2>ğŸ” Entrar no Evento</h2>
<input id="loginEvento" placeholder="Nome do evento">
<input id="loginPessoa" placeholder="Seu nome">
<button onclick="entrar()">Entrar</button>

<div id="msg" class="msg"></div>
</div>

<script>
function normalizar(t){ return t.trim().toLowerCase(); }

function mostrar(msg, ok=true){
 let box=document.getElementById("msg");
 box.style.display="block";
 box.className = "msg " + (ok?"ok":"err");
 box.innerText=msg;
}

function criarEvento(){
 let nome = normalizar(document.getElementById("eventoNome").value);
 let partRaw = document.getElementById("eventoParticipantes").value;
 if(!nome || !partRaw){ return mostrar("Preencha todos os campos!", false); }
 let participantes = partRaw.split(",").map(p=>normalizar(p)).filter(p=>p);
 localStorage.setItem("ev_"+nome, JSON.stringify({
   participantes: participantes,
   sorteios:{}
 }));
 mostrar("Evento criado com sucesso!");
}

function entrar(){
 let evento = normalizar(document.getElementById("loginEvento").value);
 let pessoa = normalizar(document.getElementById("loginPessoa").value);

 let data = localStorage.getItem("ev_"+evento);
 if(!data) return mostrar("Evento nÃ£o encontrado!", false);

 let obj = JSON.parse(data);
 if(!obj.participantes.includes(pessoa))
    return mostrar("Seu nome nÃ£o estÃ¡ na lista!", false);

 if(obj.sorteios[pessoa])
    return mostrar("VocÃª jÃ¡ realizou o sorteio!", false);

 // Realiza sorteio
 let disponiveis = obj.participantes.filter(p=>p!==pessoa && !Object.values(obj.sorteios).includes(p));
 if(disponiveis.length===0)
    return mostrar("Nenhum nome disponÃ­vel!", false);

 let sorteado = disponiveis[Math.floor(Math.random()*disponiveis.length)];
 obj.sorteios[pessoa] = sorteado;
 localStorage.setItem("ev_"+evento, JSON.stringify(obj));

 mostrar("VocÃª tirou: " + sorteado);
}
</script>

</body>
</html>
